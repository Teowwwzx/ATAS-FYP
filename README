ATAS Platform (FYP MVP) Functional Requirements Document
(FRD)

1.0 Project Overview
1.1 Project Objective: The core objective of this project (ATAS MVP) is to develop a "Structured Event Tool". This tool aims to solve the inefficiency and unreliability issues faced by Malaysian university students (for course completion) when finding industry experts to organize events.

1.2 Core Value Proposition:
- For Students: To provide a reliable, transparent channel that is 10x faster than traditional cold emailing for discovering, contacting, and successfully organizing high-quality industry experts.
- For Experts: To provide a zero-admin-cost platform that enhances personal branding and is respected, for receiving and managing high-quality speaking invitations.

1.3 MVP Scope (Out of Scope for this FRD): To ensure FYP focus, the following functions are explicitly excluded from this development scope:
- A complete instant messaging/chat system.
- Social features (e.g., Xiaohongshu-style posts, follows, likes).
- Project management (e.g., committee invitations, checklists).
- Sponsorship center.

2.0 User Roles & Permissions
The system must support the following three core roles:

2.1 Student
- Registration: Email domain for registration must verified.

Permissions:
- Create and manage their own student profile.
- Search, filter, and view "verified" expert profiles.
- Create "Event" requests.
- View and manage the status of their created events.
- Rate and review experts after an event is "Completed".
- View reviews received (from experts) (Private).

2.2 Expert
- Registration: Invitation/Approval-based. Must be approved by a system administrator in the backend to ensure high quality of the supply side.

Permissions:
- Create and manage their own detailed expert profile (e.g., bio, avatar).
- View and manage received "Event" requests.
- Approve (Accept) or Decline event requests.
- Rate and review the student organizer after an event is "Completed".
- View reviews received (from students) (The average score of reviews will be publicly displayed on their profile).

2.3 Admin
Permissions:
- Full management (CRUD) of all user accounts (Student/Expert).

Core Responsibility: To review and "verify" new expert accounts.
- Manage (CRUD) platform content, such as "Skill Areas / Tags".
- View and manage (if necessary) all "Event" and "Reviews".

3.0 Core Functional Modules
3.1 Module 1: User & Auth Module
- FR-1.1 (Registration): Students can register with a name, email, and password. The system must send a verification link to that email.
- FR-1.2 (Login): Users can authenticate using their email and password. The system must maintain their login state (Session).
- FR-1.3 (Student Profile): Allow students to upload basic information (Name, University, Major).
- FR-1.4 (Expert Profile): Allow experts to upload detailed information (Avatar, Current Company, Title, Bio, LinkedIn URL, etc.). This profile must be "verified" by an Admin before being publicly visible.

3.2 Module 2: Expert Discovery Module
- FR-2.1 (Expert List): The system must provide a page to display all "verified" experts in a card format.
- FR-2.2 (Search): Provide a search bar allowing users to search by "Expert Name" or "Company".
- FR-2.3 (Tags & Filtering):
    - The Admin must maintain a "Tag Library" in the backend (Tags, e.g., Python, UI/UX, Marketing).
    - Experts, when editing their profile, can multi-select from this "Tag Library" to mark their areas of expertise.
    - Students, on the "Expert List" page, can use these "Tags" for multi-select filtering.
- FR-2.4 (Rating Display): The expert's card and their detailed profile page must clearly display their "Average Rating" (data from Module 4.0).

3.3 Module 3: Structured Event Workflow
- FR-3.1 (Core Entity): The system must have a core entity, called or "Event".
- FR-3.2 (Event Status): The Event entity must have a clear lifecycle status. Minimum requirements:
    - DRAFT (Awaiting expert response)
    - CONFIRMED (Expert has accepted)
    - DECLINED (Expert has declined)
    - COMPLETED (Event date has passed, awaiting review)
    - RATED (Both parties have reviewed, process finished)

- FR-3.3 (Create Event):
- Student clicks "Create Event" on an "Expert Profile" page.
The system displays a standardized form. The student must fill in: Event Title, Event Format, Proposed Date & Time, Estimated Audience Size, Brief Message.
Upon submission, the system creates a new Event record with DRAFT status, linking the Student ID and Expert ID.

- FR-3.4 (Respond to Event):  
- The expert sees the DRAFT event request on their dashboard.
- The expert can perform two actions: "Accept" (changes status to CONFIRMED) or "Decline" (changes status to DECLINED).
- FR-3.5 (Confirmation Notification): When the status changes to CONFIRMED or DECLINED, the system must trigger an (automatic) email notification to the student.
- FR-3.6 (Complete Event): When the Event's end_time is past the current date, the system should automatically (e.g., via a scheduled job) update its status to COMPLETED.

3.4 Module 4: Two-Way Rating System
- FR-4.1 (Core Entity): The system must have a Review entity.
- FR-4.2 (Trigger Condition): When an Event status changes to COMPLETED, the system should display a "Pending Review" prompt on the dashboards of both the student and the expert.
- FR-4.3 (Review Data):
- The Review entity must be able to store: event_id (links to which event), reviewer_id (who wrote it), reviewee_id (who is being reviewed), rating_score (Integer 1-5), comment (Optional text). 
- FR-4.4 (Two-Way Logic):
    Student submits a review (reviewing the expert).
    Expert submits a review (reviewing the student).

- FR-4.5 (Status Update): When both parties have submitted their review (or after X days post-event, e.g., 14 days), the Event's status changes to RATED.
- FR-4.6 (Rating Calculation & Display):

The system must be able to dynamically calculate each expert's "Average Rating" (the average of rating_score from all Reviews targeting that expert).

This average score must be publicly displayed on the expert's profile page as defined in FR-2.4.

(MVP Scope): Reviews received by students are not publicly displayed.

4.0 Technical Overview
- Monorepo with `backend/` (FastAPI) and `frontend/` (Next.js) aligned to this FRD.
- Backend exposes auth, profiles, events listing, follows, and email flows.
- Frontend scaffolds pages for login/register, dashboard, event creation and profiles.

5.0 Architecture
- Backend:
  - FastAPI app registered in `backend/app/main.py`.
  - PostgreSQL via SQLAlchemy (`backend/app/database/database.py`).
  - Pydantic schemas under `backend/app/schemas/`.
  - Domain routers under `backend/app/routers/` with `api/v1` prefixes.
  - Models under `backend/app/models/` supporting Users, Profiles, Events, Reviews, Tags/Skills, Follows, Organizations, Notifications.
  - Email integration with Resend in `backend/app/services/email_service.py`.
- Frontend:
  - Next.js App Router with pages under `frontend/app/`.
  - Global layout and Toast configuration in `frontend/app/layout.tsx`.

6.0 Setup Quickstart
- Backend:
  - Create `.env` in `backend/` with `DATABASE_URL`, `SECRET_KEY`, `ALGORITHM`, `ACCESS_TOKEN_EXPIRE_MINUTES`, `RESEND_API_KEY`, `SENDER_EMAIL`.
  - `pip install -r backend/requirements.txt`
  - `alembic upgrade head`
  - `uvicorn app.main:app --reload` (defaults to port `8000`).
- Frontend:
  - `npm install` in `frontend/`
  - `npm run dev` (visit `http://localhost:3000`).

7.0 Current Endpoints (MVP)
- `GET /` — API welcome
- `GET /api/v1/ping` — admin ping
- Auth:
  - `POST /api/v1/auth/register`
  - `POST /api/v1/auth/login`
  - `GET /api/v1/auth/verify/{token}`
- Email:
  - `POST /api/v1/email/forgot-password`
  - `POST /api/v1/email/reset-password?token=...`
- Profiles:
  - `POST|GET|PUT /api/v1/profiles/{user_id}`
- Events:
  - `GET /api/v1/events/events`
- Follows:
  - `GET /api/v1/follows/follows`

8.0 Feature Plan (Implementation)
- Auth & Verification:
  - Complete email verification sending and activate on registration.
  - Add domain-based student registration validation per FR-1.1.
- Expert Discovery:
  - Implement verified expert listing with search and tag-based filter.
  - Admin tag library management UI & APIs.
- Structured Event Workflow:
  - Add endpoints for create, accept/decline, status transitions, and scheduled completion.
  - Notifications on status changes (email + in-app `Notification`).
- Two-Way Ratings:
  - Implement review submission APIs and average rating calculation for expert profile display.
- Admin:
  - Role-based access control with `require_role` middleware.
  - Expert verification flows and content management.

9.0 Known Gaps
- Tests reference `/api/v1/users/` creation but current router defines only `router` with no endpoints; align tests and routes.
- Alembic `env.py` imports `app.models.blocklist_model` but the model file is missing; either add the model or remove the import to avoid migration errors.
- Frontend pages under `app/auth/*` and `app/main/*` are placeholders; implement forms and API integration.
- Scheduler for auto-completion of events is not yet implemented.

10.0 Documentation Index
- Backend details: `backend/README.md`
- Frontend details: `frontend/README.md`
